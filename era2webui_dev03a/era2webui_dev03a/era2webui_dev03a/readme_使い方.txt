era2webui dev03

注意：このプログラムはド素人が試作した人柱版です。まともに動作することを期待しないで下さい。
何があっても自己責任での試用をお願いします。
Stable Diffusionの操作とeraのカスタマイズについてある程度慣れたユーザーを対象にしています。

-----------------------------------------------------------------------------
必要な環境
・WebUI(Automatic1111)で画像を生成する用意ができたWindowsPC
　（オンラインに構築した環境で動作するかは不明。非推奨。）
・ブラウザはGoogle Chromeを使用
・Python実行環境 パスを通す必要あり。Stable Diffusionが動いている時点でOKのはず
・emueraのバリアント
　・この人柱版は eratohoYMAEM Ver4280 （パッチなし または END追加パッチ適用）に対応しています。
・デバッガ（推奨）
　・ERBやCSVをいじるとよく停止するので、デバッガでの実行を推奨します。VSCodeおすすめ
・CSVエディタ（推奨）
　・カスタマイズに使う

-----------------------------------------------------------------------------
セットアップ
1.Pythonで下記のライブラリをインストールしておく
　pandas,Numpy,selenium,watchdog
2.Chromeのwebdriverをダウンロードし、ドライバーを本体(era2webui.py)と同じフォルダに置く
　または適当な場所に置いてパスを通す
　※webdriverのバージョンは、Chromeのバージョンと同じものを使用してください。
3.eratohoのERBフォルダに、同梱のERBフォルダを上書きする。
　※csvfilesはeratohoのcsvに上書きしてはいけません。

-----------------------------------------------------------------------------
使い方
1.いつも通りに、webui-user.batを実行して少し待つ
2.「1st_chrome起動.bat」を実行
　ChromeでWebUIが開かれる
3.「2nd_py起動.bat」を実行
4.フォルダ選択ダイアログが表示されるので、eratohoのsavフォルダを開く
5.初回起動時のみ、再度フォルダ選択ダイアログが表示されるので、stalediffusionの画像生成フォルダを開く
6.eratohoで普通に遊ぶと画像が作られる
画像表示のGUIを消しても生成・検知は動いています。


設定ファイル（config.ini）
・解像度自動変更(初期値1)　1にすると生成解像度の自動変更が有効になる。0で無効
・キューの最大サイズ(初期値2)　未完の画像生成オーダーをいくつまで貯め込むか。高くするとずっと過去のコマンドを処理している状態になる。あえて高くしてハイレゾ生成放置で遊ぶのもいいぞ

TIPS
※WebUIでのモデルの変更・解像度の変更などの操作はどのタイミングでも行ってかまいません。
※eratohoの操作は画像の生成を待つ必要はありません。ストックされたオーダーを順番に処理します。初期設定では、生成待ちのオーダーが3つを超えると古いものから破棄します。
※調教メニュー機能を実行した時は画像生成されません
※初回起動時、キャッシュフォルダが2つほどできます。たぶん消していいやつです。(__pycache__とchromeuserdata)


カスタマイズ
csvfilesフォルダの中身を編集してプロンプトを変更できます
best qualityやEasyNegativeを書くところはEffect.csvにあります